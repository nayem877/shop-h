<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>THE MAX | Ultimate v4.0</title>
    <link href="https://fonts.googleapis.com/css2?family=Hind+Siliguri:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <style>
        :root{ --primary:#2ea043; --bg:#0b1118; --card:#1c2128; --text:#ffffff; --border:#30363d; --error: #ff4444; }
        .light-mode { --bg:#f0f2f5; --card:#ffffff; --text:#1c1e21; --border:#ddd; }
        *{ box-sizing:border-box; margin:0; padding:0; font-family:'Hind Siliguri', sans-serif; }
        body{ background:var(--bg); color:var(--text); transition:.4s; overflow-x: hidden; }

        /* Loader & Toasts */
        #loader { position: fixed; top: 0; left: 0; width: 100%; height: 4px; background: var(--primary); z-index: 5000; display: none; }
        .toast { position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%); background: var(--primary); color: white; padding: 12px 25px; border-radius: 50px; display: none; z-index: 6000; box-shadow: 0 5px 15px rgba(0,0,0,0.3); }

        header{ display:flex; justify-content:space-between; align-items:center; padding:15px; border-bottom:2px solid var(--primary); position:sticky; top:0; background:var(--bg); z-index:1000; }
        .logo{ font-size:24px; font-weight:700; color:var(--primary); text-transform: uppercase; letter-spacing: 1px; }
        .nav-icons { display: flex; gap: 15px; align-items: center; }
        .icon-btn { cursor: pointer; font-size: 20px; color: var(--primary); }
        .lang-btn { background: var(--primary); color: white; border: none; padding: 6px 14px; border-radius: 8px; cursor: pointer; font-weight: bold; }

        .search-area { padding: 15px; }
        .search-bar { width: 100%; padding: 14px; border-radius: 12px; border: 1px solid var(--border); background: var(--card); color: var(--text); outline: none; font-size: 16px; }

        .cat-scroll { display: flex; gap: 10px; padding: 0 15px 15px; overflow-x: auto; scrollbar-width: none; }
        .cat-chip { background: var(--card); border: 1px solid var(--border); padding: 8px 20px; border-radius: 25px; white-space: nowrap; cursor: pointer; transition: 0.3s; font-size: 14px; }
        .cat-chip.active { background: var(--primary); color: white; border-color: var(--primary); }

        #admin-box{ display:none; padding:20px; background: rgba(46, 160, 67, 0.05); border: 1px dashed var(--primary); margin: 15px; border-radius: 20px; }
        .in { width:100%; padding:12px; margin-bottom:10px; border-radius:10px; border:1px solid var(--border); background: var(--card); color: var(--text); }

        .grid{ display:grid; grid-template-columns: 1fr 1fr; gap:12px; padding:15px; }
        .card{ background:var(--card); border-radius:20px; padding:12px; text-align:center; border:1px solid var(--border); position: relative; animation: fadeIn 0.5s; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .card img{ width:100%; height:160px; object-fit:cover; border-radius:15px; cursor: pointer; }
        .card h4 { margin: 12px 0 5px; font-size: 15px; height: 40px; overflow: hidden; line-height: 1.3; }
        .price{ color:var(--primary); font-weight:700; font-size: 18px; margin-bottom: 12px; display: block; }
        .buy-btn{ background:var(--primary); color:white; padding:12px; border-radius:12px; width: 100%; border: none; font-weight: bold; cursor: pointer; font-size: 14px; }
        .del { position: absolute; top: 8px; right: 8px; background: var(--error); color: white; border: none; width: 26px; height: 26px; border-radius: 50%; cursor: pointer; display: none; z-index: 5; }

        /* Full Details Modal */
        .modal{ display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.9); justify-content:center; align-items:center; z-index:3000; padding:20px; }
        .modal-content { background: var(--card); padding: 25px; border-radius: 25px; width: 100%; max-width: 500px; max-height: 90vh; overflow-y: auto; position: relative; }
        .video-box { width: 100%; height: 200px; border-radius: 15px; margin: 15px 0; background: #000; }
        .feature-item { display: flex; align-items: center; gap: 10px; margin-bottom: 8px; font-size: 14px; color: #aaa; }
        .color-dot { width: 15px; height: 15px; border-radius: 50%; border: 1px solid #fff; display: inline-block; }

        footer { padding: 40px 20px; text-align: center; border-top: 1px solid var(--border); margin-top: 30px; }
        .socials { display: flex; justify-content: center; gap: 25px; margin-bottom: 15px; }
        .socials a { color: var(--primary); font-size: 28px; transition: 0.3s; }
    </style>
</head>
<body class="dark-mode">

<div id="loader"></div>
<div id="toast" class="toast"></div>

<header>
    <div class="logo">THE MAX</div>
    <div class="nav-icons">
        <button class="lang-btn" onclick="toggleLanguage()" id="lSwitch">EN</button>
        <i class="fas fa-moon icon-btn" onclick="toggleTheme()" id="tIcon"></i>
        <i class="fas fa-lock icon-btn" onclick="authAdmin()"></i>
    </div>
</header>

<div class="search-area">
    <input type="text" id="sInp" class="search-bar" placeholder="পণ্য খুঁজুন..." oninput="syncFilter()">
</div>

<div class="cat-scroll">
    <div class="cat-chip active" onclick="setCategory('all', this)" id="cAll">সব পণ্য</div>
    <div class="cat-chip" onclick="setCategory('watch', this)" id="cW">ঘড়ি</div>
    <div class="cat-chip" onclick="setCategory('headphone', this)" id="cH">হেডফোন</div>
    <div class="cat-chip" onclick="setCategory('gadget', this)" id="cG">গ্যাজেট</div>
</div>

<div id="admin-box">
    <h3 id="aHead">➕ নতুন পণ্য</h3><br>
    <input type="text" id="pName" class="in" placeholder="নাম">
    <input type="number" id="pPrice" class="in" placeholder="মূল্য (৳)">
    <input type="text" id="pImg" class="in" placeholder="ছবির ডিরেক্ট লিঙ্ক">
    <input type="text" id="pVid" class="in" placeholder="YouTube ভিডিও লিঙ্ক (ঐচ্ছিক)">
    <input type="text" id="pColors" class="in" placeholder="কালারসমূহ (যেমন: Black, Red)">
    <input type="text" id="pFeatures" class="in" placeholder="বৈশিষ্ট্যসমূহ (কমা দিয়ে লিখুন)">
    <input type="text" id="pWarranty" class="in" placeholder="ওয়ারেন্টি">
    <select id="pCat" class="in">
        <option value="watch">Watch</option>
        <option value="headphone">Headphone</option>
        <option value="gadget">Gadget</option>
    </select>
    <button class="buy-btn" onclick="uploadProduct()" id="aBtn">সেভ করুন</button>
</div>

<div class="grid" id="main-grid"></div>

<div class="modal" id="pModal">
    <div class="modal-content">
        <i class="fas fa-times" style="position:absolute; top:15px; right:20px; cursor:pointer;" onclick="closeM()"></i>
        <h3 id="mTitle">পণ্যের বিবরণ</h3>
        <div id="mBody"></div>
        <hr style="margin:20px 0; border:0.5px solid var(--border)">
        <h3 id="oHead">অর্ডার ফরম</h3><br>
        <input type="text" id="oName" class="in" placeholder="আপনার নাম">
        <input type="text" id="oPhone" class="in" placeholder="মোবাইল নম্বর">
        <input type="text" id="oAddr" class="in" placeholder="পূর্ণ ঠিকানা">
        <p style="font-size:12px; margin-bottom:10px;">বিকাশ/নগদ (পার্সোনাল): <b>01788350024</b></p>
        <input type="text" id="oTrx" class="in" placeholder="TrxID (টাকা পাঠানোর পর)">
        <button class="buy-btn" id="oBtn" onclick="placeOrder()">অর্ডার নিশ্চিত করুন</button>
    </div>
</div>

<footer>
    <div class="socials">
        <a href="https://www.facebook.com/share/17ZHe2aFT1/" target="_blank"><i class="fab fa-facebook"></i></a>
        <a href="https://www.youtube.com/@TheMaxshoph" target="_blank"><i class="fab fa-youtube"></i></a>
    </div>
    <p>© 2026 THE MAX - Nayem Hossen</p>
</footer>

<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>

<script>
    const fbConfig = {
        apiKey: "AIzaSyAoZzONz8I2W70_b4oR_7cGxbQCmDaipWg",
        authDomain: "shop-h-215df.firebaseapp.com",
        projectId: "shop-h-215df",
        appId: "1:60483176788:web:cdadf8c99fccb3d20620c1"
    };
    firebase.initializeApp(fbConfig);
    const db = firebase.firestore(), auth = firebase.auth();

    let isAdmin = false, prods = [], curCat = 'all', lang = 'BN';
    let selectedP = null;

    const dictionary = {
        BN: { s: "পণ্য খুঁজুন...", all: "সব পণ্য", w: "ঘড়ি", hp: "হেডফোন", gd: "গ্যাজেট", buy: "বিস্তারিত ও কিনুন", aH: "➕ নতুন পণ্য", aB: "সেভ করুন", oH: "অর্ডার ফরম", oB: "অর্ডার নিশ্চিত করুন", mH: "পণ্যের বিবরণ", success: "অর্ডার সফল হয়েছে!", name: "নাম", ph: "ফোন", ad: "ঠিকানা" },
        EN: { s: "Search products...", all: "All Products", w: "Watch", hp: "Headphones", gd: "Gadgets", buy: "View & Buy", aH: "➕ Add Product", aB: "Save Product", oH: "Order Form", oB: "Confirm Order", mH: "Product Details", success: "Order Placed!", name: "Your Name", ph: "Phone No", ad: "Full Address" }
    };

    function toggleLanguage() {
        lang = lang === 'BN' ? 'EN' : 'BN';
        document.getElementById('lSwitch').innerText = lang === 'BN' ? 'EN' : 'BN';
        document.getElementById('sInp').placeholder = dictionary[lang].s;
        document.getElementById('cAll').innerText = dictionary[lang].all;
        document.getElementById('cW').innerText = dictionary[lang].w;
        document.getElementById('cH').innerText = dictionary[lang].hp;
        document.getElementById('cG').innerText = dictionary[lang].gd;
        document.getElementById('aHead').innerText = dictionary[lang].aH;
        document.getElementById('aBtn').innerText = dictionary[lang].aB;
        document.getElementById('oHead').innerText = dictionary[lang].oH;
        document.getElementById('oBtn').innerText = dictionary[lang].oB;
        document.getElementById('mTitle').innerText = dictionary[lang].mH;
        render();
    }

    async function authAdmin() {
        if(isAdmin) return auth.signOut();
        const e = prompt("Email:"), p = prompt("Pass:");
        if(e && p) await auth.signInWithEmailAndPassword(e, p).catch(()=>alert("Login Failed"));
    }

    auth.onAuthStateChanged(u => {
        isAdmin = u && u.email === "nayemhossen20005@gmail.com";
        document.getElementById('admin-box').style.display = isAdmin ? 'block' : 'none';
        db.collection('products').orderBy('createdAt', 'desc').onSnapshot(s => {
            prods = s.docs.map(d => ({id: d.id, ...d.data()}));
            render();
        });
    });

    async function uploadProduct() {
        const p = {
            name: document.getElementById('pName').value,
            price: Number(document.getElementById('pPrice').value),
            img: document.getElementById('pImg').value,
            vid: document.getElementById('pVid').value,
            colors: document.getElementById('pColors').value,
            features: document.getElementById('pFeatures').value,
            warranty: document.getElementById('pWarranty').value,
            cat: document.getElementById('pCat').value,
            createdAt: firebase.firestore.FieldValue.serverTimestamp()
        };
        document.getElementById('loader').style.display = 'block';
        await db.collection('products').add(p);
        document.getElementById('loader').style.display = 'none';
        msg("Product Added!");
    }

    function render() {
        const term = document.getElementById('sInp').value.toLowerCase();
        const grid = document.getElementById('main-grid');
        const filtered = prods.filter(p => (curCat === 'all' || p.cat === curCat) && p.name.toLowerCase().includes(term));
        
        grid.innerHTML = filtered.map(p => `
            <div class="card">
                <button class="del" style="display:${isAdmin?'block':'none'}" onclick="delP('${p.id}')">×</button>
                <img src="${p.img}" onclick="openM('${p.id}')">
                <h4>${p.name}</h4>
                <span class="price">৳${p.price}</span>
                <button class="buy-btn" onclick="openM('${p.id}')">${dictionary[lang].buy}</button>
            </div>
        `).join('');
    }

    function openM(id) {
        selectedP = prods.find(p => p.id === id);
        let vidHTML = selectedP.vid ? `<iframe class="video-box" src="${selectedP.vid.replace('watch?v=', 'embed/')}" frameborder="0" allowfullscreen></iframe>` : '';
        let featHTML = selectedP.features ? selectedP.features.split(',').map(f => `<div class="feature-item"><i class="fas fa-check-circle" style="color:var(--primary)"></i> ${f.trim()}</div>`).join('') : '';
        
        document.getElementById('mBody').innerHTML = `
            ${vidHTML}
            <div style="margin-top:15px;">
                <p><b>Colors:</b> ${selectedP.colors || 'N/A'}</p>
                <p><b>Warranty:</b> ${selectedP.warranty || 'No'}</p><br>
                ${featHTML}
            </div>
        `;
        document.getElementById('pModal').style.display = 'flex';
    }

    function closeM() { document.getElementById('pModal').style.display = 'none'; }

    async function placeOrder() {
        const o = {
            item: selectedP.name,
            customer: document.getElementById('oName').value,
            phone: document.getElementById('oPhone').value,
            address: document.getElementById('oAddr').value,
            trx: document.getElementById('oTrx').value,
            time: firebase.firestore.FieldValue.serverTimestamp()
        };
        if(!o.customer || !o.phone) return alert("Fill Name/Phone!");
        document.getElementById('loader').style.display = 'block';
        await db.collection('orders').add(o);
        document.getElementById('loader').style.display = 'none';
        msg(dictionary[lang].success);
        closeM();
    }

    async function delP(id) { if(confirm("Delete?")) await db.collection('products').doc(id).delete(); }
    function setCategory(c, b) {
        curCat = c;
        document.querySelectorAll('.cat-chip').forEach(x => x.classList.remove('active'));
        b.classList.add('active');
        render();
    }
    function syncFilter() { render(); }
    function msg(m) {
        const t = document.getElementById('toast');
        t.innerText = m; t.style.display = 'block';
        setTimeout(() => t.style.display = 'none', 3000);
    }
    function toggleTheme() {
        document.body.classList.toggle('light-mode');
        const icon = document.getElementById('tIcon');
        icon.classList.toggle('fa-sun'); icon.classList.toggle('fa-moon');
    }
</script>
</body>
</html>
